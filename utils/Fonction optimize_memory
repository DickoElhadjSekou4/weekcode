import pandas as pd

def optimize_memory(df):
    
    for col in df.columns:  # Parcours toutes les colonnes du DataFrame
        col_type = df[col].dtype  # Récupère le type de la colonne
        
        # Optimisation des entiers (int64 → int32 ou plus petit)
        if col_type == 'int64':
            df[col] = pd.to_numeric(df[col], downcast='integer')  
        
        # Optimisation des flottants (float64 → float32)
        elif col_type == 'float64':
            df[col] = pd.to_numeric(df[col], downcast='float')  

    return df  # Retourne le DataFrame optimisé
